name: ynet

topology:
  defaults:
    kind: nokia_srlinux
    type: ixrd3
    image: ghcr.io/nokia/srlinux:21.11.2

  nodes:
    s1:
      startup-config: config/srl-s1.cfg
      mgmt-ipv4: 172.20.20.11
      group: spine

    s2:
      startup-config: config/srl-s2.cfg
      mgmt-ipv4: 172.20.20.12
      group: spine

    l1:
      startup-config: config/srl-l1.cfg
      mgmt-ipv4: 172.20.20.21
      group: leaf

    l2:
      startup-config: config/srl-l2.cfg
      mgmt-ipv4: 172.20.20.22
      group: leaf

    l3:
      startup-config: config/srl-l3.cfg
      mgmt-ipv4: 172.20.20.23
      group: leaf

    b1:
      startup-config: config/srl-b1.cfg
      mgmt-ipv4: 172.20.20.31
      group: leaf

    h1:
      kind: linux
      image: akpinar/alpine:latest
      mgmt-ipv4: 172.20.20.51
      exec:
        - ip addr add 192.168.1.11/24 dev eth1
        - ip route replace default via 192.168.1.1 dev eth1
      group: server
      
    h2:
      kind: linux
      image: akpinar/alpine:latest
      mgmt-ipv4: 172.20.20.52
      exec:
        - ip addr add 192.168.2.11/24 dev eth1
        - ip route replace default via 192.168.2.1 dev eth1
      group: server
      
    h3:
      kind: linux
      image: akpinar/alpine:latest
      mgmt-ipv4: 172.20.20.53
      exec:
        - ip addr add 192.168.3.11/24 dev eth1
        - ip route replace default via 192.168.3.1 dev eth1
      group: server

  links:
    - endpoints: ["s1:e1-11", "l1:e1-11"]
    - endpoints: ["s1:e1-12", "l2:e1-11"]
    - endpoints: ["s1:e1-13", "l3:e1-11"]
    - endpoints: ["s1:e1-21", "b1:e1-11"]

    - endpoints: ["s2:e1-11", "l1:e1-12"]
    - endpoints: ["s2:e1-12", "l2:e1-12"]
    - endpoints: ["s2:e1-13", "l3:e1-12"]
    - endpoints: ["s2:e1-21", "b1:e1-12"]

    - endpoints: ["l1:e1-21", "h1:eth1"]
    - endpoints: ["l2:e1-21", "h2:eth1"]
    - endpoints: ["l3:e1-21", "h3:eth1"]

mgmt:
  ipv4-subnet: 172.20.20.0/24
  ipv6-subnet: 2001:172:20::/80
